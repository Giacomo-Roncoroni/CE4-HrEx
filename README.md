# CE4-HrEx

This repository contains the codes and resources associated with the research paper titled: "Deep Learning driven interpretation of Chang’E-4 Lunar Penetrating Radar", authored by Roncoroni G., Forte E., Santin I., Černok A., Rajšić A., Frigeri A., Zhao W., Fang G., Pipan M.

## Abstract

In this study, we reprocessed Chang’E-4 Lunar Penetrating Radar (LPR) data collected until 27th March 2023, extending the analyzed profile length to about 1,440 meters—an addition of more than 400 meters compared to the longest previously published profile. We employed a novel Deep Learning-based algorithm to automatically extract subsurface reflectors from the processed radar data. The outputs are represented as horizon probability maps, which we further interpreted by integrating signal attribute analysis with orbital imagery. This method significantly reduces the subjectivity inherent in traditional data interpretation techniques, allowing for a more objective connection between radar reflectors, their geological context, and surface structures. For the first time, dipping layers and at least twenty shallow buried crater-like structures within the regolith were imaged using Lunar Penetrating Radar data. Additionally, four deeper crater-like structures were identified, along with a crater rim crossed by the rover's path and confirmed by satellite imagery.

## Repository Structure

- `model_final_NN0_long2_retr_new`: This is the trained deep learning model used for horizon extraction from the LPR data.
- `notebooks/`: This directory contains Jupyter Notebooks used during the research, including data preprocessing, model training, and interpretation of results.
- `data/`: Contains the reprocessed LPR data, model input data, and any relevant supplementary data used in the study.
- `scripts/`: Contains Python scripts used for data handling, model evaluation, and additional analyses.

## Usage
### Running the Model

To use the trained model (`model_final_NN0_long2_retr_new`) for horizon extraction on new data, follow the instructions in the `run_model.ipynb` notebook located in the `notebooks/` directory. This notebook provides step-by-step guidance on loading the model, preprocessing the input data, and generating horizon probability maps.

### Data Interpretation

The interpretation of the horizon probability maps generated by the model can be performed by integrating the results with orbital imagery. This process is demonstrated in the `interpretation.ipynb` notebook, where examples from the study are provided.

### Results

The repository includes the following key results:

- Horizon probability maps showing the likelihood of subsurface reflectors.
- Detailed analysis of the identified structures, including dipping layers and buried crater-like formations.
- Integrated interpretations combining radar data with satellite imagery to contextualize the subsurface structures within the geological framework of the lunar surface.

### Contributing

We welcome contributions to this repository. If you have suggestions for improvements or additional features, please submit a pull request or open an issue.

### License

This project is licensed under the MIT License. See the `LICENSE` file for details.

### Citation

If you use this code or data in your research, please cite the original paper:

> Roncoroni G., Forte E., Santin I., Černok A., Rajšić A., Frigeri A., Zhao W., Fang G., Pipan M. "Deep Learning driven interpretation of Chang’E-4 Lunar Penetrating Radar". Icarus, 2024, DOI: 10.1016/j.icarus.2024.116219.
